<% layout('./layouts/boilerplate') -%>
<% block('head').append(`<title>Edit ${campground.title}</title>`) %>

     <%const getCity = () => {
        let target = campground.location.search(/, /);
        return campground.location.slice(0, target)} %>
    <%const getState = () =>{
        let target = campground.location.search(/, /);
        return campground.location.slice(target+2)} %>


    <h1 class="text-center">Edit Campground</h1>
    <div class="container w-50">
    <form aform action="/campgrounds/<%= campground._id %>?_method=PUT" method="POST">
        
        <div class="row mb-3 justify-content-center">
            
            <div class="col-lg-6">
                <label for="title" class="form-label">Campground Name</label>
                <input type="text" class="form-control" id="title" aria-describedby="titleHelp" name="campground[title]" value="<%= campground.title %>">
                <div id="titleHelp" class="form-text">Please enter a suitable name for your camp.</div>
            </div> 
            <div class="col-lg-6">
                <label for="price" class="form-label">Campground Price</label>
                <div class="input-group">
                    <span class="input-group-text">$</span>
                    
                <input type="number" name="campground[price]" id="price" step=".01" min=".01" required class="form-control" aria-describedby="priceHelp" value= "<%= campground.price.toFixed(2) %>">
                
                </div>
                <div id="priceHelp" class="form-text">Please enter a price.</div>
                
            </div> 
            
        </div>
        <row class="row mb-3">
            <div class="col-lg-6">
                <label for="city" class="form-label">Campground City</label>
                <input type="text" name="campground[city]" id="city" required class="form-control" aria-describedby="cityHelp" value="<%= getCity() %>">
                <div id="cityHelp" class="form-text">Please enter the city your camp is located in.</div>
                
            </div> 
            <state class="col-lg-6">
                <label for="state" class="form-label">Campground State</label>
                <select name="campground[state]" id="state" aria-required required class="form-select" aria-describedby="stateHelp">
                    <% const stateNames = [
                    'Alabama', 'Alaska', 'Arizona', 'Arkansas', 'California', 'Colorado', 'Connecticut',
                    'Delaware', 'Florida', 'Georgia', 'Hawaii', 'Idaho', 'Illinois', 'Indiana', 'Iowa', 'Kansas',
                    'Kentucky', 'Louisiana', 'Maine', 'Maryland', 'Massachusetts', 'Michigan', 'Minnesota', 
                    'Mississippi', 'Missouri', 'Montana', 'Nebraska', 'Nevada', 'New Hampshire', 'New Jersey', 
                    'New Mexico', 'New York', 'North Carolina', 'North Dakota', 'Ohio', 'Oklahoma', 'Oregon',
                    'Pennsylvania', 'Rhode Island', 'South Carolina', 'South Dakota', 'Tennessee', 'Texas', 'Utah', 
                    'Vermont', 'Virginia', 'Washington', 'West Virginia', 'Wisconsin', 'Wyoming'
                ];
                stateNames.forEach(state => { %>
                    <option value="<%= state%>"
                        <%if(state === getState()){%>
                        selected = true
                        <% } %>><%= state%> 
                        </option>
                    <% }) %>
                </select>
                <div id="stateHelp" class="form-text">Please enter the state your camp is located in.</div>
            </state> 
            
        </row>
        <div class="row mb-3 ">
            <div class="col-lg-6">
                <label for="description" class="form-label">Enter campground description:</label>
                <textarea class="form-control" name="campground[description]" id="description" cols="30" rows="3" aria-placeholder="Enter campground description" placeholder="Enter campground description"><%=campground.description%></textarea>
            </div>
            <div class="col-lg-6">
                <label for="image" class="form-label">Image URL</label>
                <input type="text" class="form-control" id="image" aria-describedby="imageHelp" name="campground[image]" value="<%=campground.image%>">
                <div id="imageHelp" class="form-text">Please enter a image URL for your camp.</div>
            </div> 
            
            
        </div>
        <div class="row mb-3">
            <div class="col-lg-3">
            <button class="btn btn-success">Update Campground</button>
            
            </div>
          
        </div>
        
        <div>
        <a class="btn btn-primary" role="button"href="/campgrounds/<%= campground._id %>">Go Back</a>
    </div>
    </div>
        